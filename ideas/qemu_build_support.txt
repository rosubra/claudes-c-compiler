QEMU Build Support Status
=========================

Summary: QEMU 10.2.50 can be compiled (1700+ C files) and linked using ccc-x86
without any gcc wrapper workarounds. --version and -cpu help work correctly.
System emulation (kernel boot) still has a runtime issue in JSON/QMP event
serialization.

Build Status:
- Configure: PASS
- Compilation: PASS (all files including qapi-introspect.c compile natively)
- Linking: PASS
- Runtime: PARTIAL - "--version" and "-cpu help" work, but kernel boot crashes
  with JSON parse error in QMP event building

Build Steps:
  1. Copy QEMU source to writable location (cp -r /deps/qemu /tmp/qemu_build)
  2. Configure out-of-tree:
     cd /tmp/qemu_build && mkdir build && cd build
     ../configure --cc=/path/to/ccc-x86
       --target-list=x86_64-softmmu --disable-docs --disable-gtk --disable-sdl
       --disable-opengl --disable-virglrenderer --disable-spice --disable-vte
       --disable-curses
  3. Build: ninja -j$(nproc) qemu-system-x86_64
  Note: `make -j128` builds all targets including test libraries. One test file
  (virtio-9p-client.c) fails due to __attribute__((common, weak)) interaction
  with the assembler. Use `ninja qemu-system-x86_64` to build just the emulator.

Known Issues Fixed:
  1. __has_attribute macro aliasing (cleanup attribute) - FIXED
  2. Bitfield ICE in global_init_compound_struct - FIXED
  3. Response file (@file) support - FIXED
  4. Compound literal array init (CPU double-registration) - FIXED
  5. Bool pointer array init (migration crash) - FIXED
  6. Preprocessor MAX_PENDING_NEWLINES too low for qapi-introspect.c - FIXED
     The preprocessor's line accumulation limit for multi-line macro invocations
     was 2000 lines, but QEMU's QLIT_QLIST() macro spans ~32000 lines.
     Increased to 100,000.

Remaining Issues:
  1. Test library virtio-9p-client.c: __attribute__((common, weak)) on
     global_qtest causes assembler error "symbol can not be both weak and common".
     Not blocking - only affects test targets, not the main emulator binary.
  2. JSON parse error during kernel boot:
     "Unexpected error in json_message_process_token()" / "JSON parse error, stray '{'"
     Crashes in qobject_from_jsonv() -> qdict_from_jsonf_nofail() when building
     QMP event dict during vm_start(). The backtrace:
     - qapi_event_send_resume() calls qmp_event_build_dict()
     - qmp_event_build_dict() calls qdict_from_jsonf_nofail()
     - qdict_from_jsonf_nofail() -> qobject_from_vjsonf_nofail() -> qobject_from_jsonv()
     - JSON parsing fails with "stray '{'"
     This might be a variadic function argument passing issue or a string
     formatting bug affecting how JSON template strings are passed through
     the va_list/printf-style argument chain.

Priority: Medium - QEMU can be built natively using ccc-x86 and runs basic
commands. Kernel boot runtime issue is the remaining blocker.
