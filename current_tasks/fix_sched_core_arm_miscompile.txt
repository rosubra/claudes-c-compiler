Task: Fix kernel/sched/core.c ARM miscompilation - constant switch folding
Status: completed
Started: 2026-01-27

Problem: After inlining always_inline functions containing switch statements,
the switch value becomes a known constant. The CFG simplification pass only
folded CondBranch terminators with constant conditions, not Switch terminators.
This caused the compiler to emit massive runtime comparison chains against
known constants (e.g., comparing the constant 37 against 21 other constants).

In the Linux kernel, this manifested in cpucap_is_possible() calls within
kernel/sched/core.c: each call to cpucap_is_possible(37) generated 65+
instructions of dead runtime dispatch code instead of resolving to a single
constant at compile time.

Fix: Added fold_constant_switches() to cfg_simplify.rs that resolves
Switch { val: Const(N), cases, default } to Branch(matched_target), with
proper phi node cleanup for not-taken targets.

Note: sched/core.c still has additional boot issues (preemption imbalance)
that appear to be caused by other compiler limitations (function inlining
depth, bit-test codegen). The constant switch folding fix addresses one
specific miscompilation pattern.
